@using System.Globalization
@inject IJSRuntime JS
@inject NavigationManager Navigation

<MudMenu DisableElevation Label="@selectedCulture?.TwoLetterISOLanguageName" StartIcon="@Icons.Material.Filled.Translate" EndIcon="@Icons.Material.Filled.KeyboardArrowDown" Color="Color.Inherit" Dense="true">
    <MudMenuItem OnClick="@( () => ApplySelectedCultureAsync("en-US"))">EN</MudMenuItem>
    <MudMenuItem OnClick="@( () => ApplySelectedCultureAsync("es-419"))">ES</MudMenuItem>
</MudMenu>

@code
{
    private CultureInfo? selectedCulture;

    protected override void OnInitialized()
    {
        selectedCulture = CultureInfo.CurrentCulture;
    }

    private async Task ApplySelectedCultureAsync(string culture)
    {
        selectedCulture = new CultureInfo(culture);
        if (CultureInfo.CurrentCulture != selectedCulture)
        {
            await JS.InvokeVoidAsync("blazorCulture.set", selectedCulture!.Name);

            Navigation.NavigateTo(Navigation.Uri, forceLoad: true);
        }
    }
}